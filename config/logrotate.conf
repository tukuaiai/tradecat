# TradeCat 日志轮转配置
# ============================================================
# 使用方法:
#   1. 复制并替换路径:
#      cd /path/to/tradecat
#      sed -e "s|{{PROJECT_ROOT}}|$(pwd)|g" -e "s|{{USER}}|$(whoami)|g" \
#          config/logrotate.conf > /tmp/tradecat-logrotate.conf
#
#   2. 手动执行轮转:
#      sudo logrotate -f /tmp/tradecat-logrotate.conf
#
#   3. 安装到系统 (自动每日执行):
#      sudo cp /tmp/tradecat-logrotate.conf /etc/logrotate.d/tradecat
#
#   4. 测试配置:
#      logrotate -d /tmp/tradecat-logrotate.conf
#
# 占位符说明:
#   {{PROJECT_ROOT}} - 项目根目录绝对路径
#   {{USER}}         - 运行服务的用户名
# ============================================================

# 核心服务日志 (services/)
{{PROJECT_ROOT}}/services/*/logs/*.log {
    daily
    rotate 14
    size 50M
    compress
    delaycompress
    missingok
    notifempty
    copytruncate
    dateext
    dateformat -%Y%m%d
    su {{USER}} {{USER}}
}

# 预览服务日志 (services-preview/)
{{PROJECT_ROOT}}/services-preview/*/logs/*.log {
    daily
    rotate 7
    size 50M
    compress
    delaycompress
    missingok
    notifempty
    copytruncate
    dateext
    dateformat -%Y%m%d
    su {{USER}} {{USER}}
}

# 项目根目录日志 (daemon.log, alerts.log)
{{PROJECT_ROOT}}/*.log {
    daily
    rotate 7
    size 20M
    compress
    delaycompress
    missingok
    notifempty
    copytruncate
    dateext
    dateformat -%Y%m%d
    su {{USER}} {{USER}}
}
